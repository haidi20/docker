node {
  checkout scm

  def apiImage = docker.image("api")

  apiImage.inside {
    def dbImage = docker.image("db")
    
    stage("version python") {
      sh "python --version"
    }

    stage("test django") {
      dbImage.inside {
        sh 'python app/manage.py test ./app'
      }
    }
  }
}